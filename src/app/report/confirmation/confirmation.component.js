"use strict";var __decorate=this&&this.__decorate||function(t,e,o,r){var i,n=arguments.length,s=n<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,o):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,o,r);else for(var l=t.length-1;0<=l;l--)(i=t[l])&&(s=(n<3?i(s):3<n?i(e,o,s):i(e,o))||s);return 3<n&&s&&Object.defineProperty(e,o,s),s};Object.defineProperty(exports,"__esModule",{value:!0});var core_1=require("@angular/core"),operators_1=require("rxjs/operators"),http_1=require("@angular/common/http"),file_saver_1=require("file-saver"),forms_1=require("@angular/forms"),ConfirmationComponent=function(){function t(t,e,o){this.basedataservice=t,this.reportservice=e,this.fb=o,this.userall={},this.userselect={},this.unitholderno="init",this.nolist=!1}return t.prototype.ngOnInit=function(){this.createFormValidate(),this.getSelectListUnitholder(),$("#mutual-tab-menu").find("li").removeClass("current"),$("#mutual-tab-menu").find("li#menu8").addClass("current"),$(".selectpicker").selectpicker();var t=new Date,e=new Date(t.getFullYear(),t.getMonth(),t.getDate()+1);console.log(e),this.minDate={year:e.getFullYear(),month:e.getMonth()+1,day:e.getDate()}},t.prototype.onChange=function(){for(var t=0;t<this.userall.unitholderlist.length;t++)this.userall.unitholderlist[t].UnitholderId==this.unitholderno.UnitholderId&&(this.userselect=this.userall.unitholderlist[t])},t.prototype.createFormValidate=function(){this.formconfirm=this.fb.group({dateorder:[null,[forms_1.Validators.required]]})},t.prototype.validateAllFormFields=function(o){var r=this;Object.keys(o.controls).forEach(function(t){var e=o.get(t);e instanceof forms_1.FormControl?e.markAsTouched({onlySelf:!0}):e instanceof forms_1.FormGroup&&r.validateAllFormFields(e)})},t.prototype.isFieldNotValid=function(t){return!this.formconfirm.get(t).valid&&this.formconfirm.get(t).touched},t.prototype.ValidatorDisplayCss=function(t){return{"has-danger":this.isFieldNotValid(t)}},t.prototype.getSelectListUnitholder=function(){var e=this;this.basedataservice.getSelectListUnitholder().pipe(operators_1.first()).subscribe(function(t){e.userall=t,e.unitholderno=e.userall.unitholderlist[0],e.userselect=e.userall.unitholderlist[0]},function(t){console.log(t)})},t.prototype.getEffectiveDate=function(){return this.model.year+"-"+this.model.month+"-"+this.model.day},t.prototype.OnSubmitd=function(){var t,e=this;this.confirmlist=[],this.loading=!0,this.nolist=!1,console.log(this.model),console.log(this.formconfirm),this.formconfirm.valid?(t={UnitholderID:this.userselect.UnitholderId,EffectiveDate:this.formconfirm.controls.dateorder.value.year+"-"+this.formconfirm.controls.dateorder.value.month+"-"+this.formconfirm.controls.dateorder.value.day},console.log(t),this.reportservice.confirmation(t).subscribe(function(t){console.log(t),e.confirmlist=t,(e.confirmlist.length=0)&&(e.nolist=!0,console.log("notlist")),console.log(e.confirmlist.length),e.loading=!1},function(t){console.log(t),e.loading=!1})):(this.loading=!1,this.validateAllFormFields(this.formconfirm))},t.prototype.download=function(t){var e=this;this.loading=!0;var o=t,r=this.confirmlist[o].ConfirmationName,i={UnitholderID:this.userselect.UnitholderId,OrderID:this.confirmlist[o].OrderID,TxType:this.type(this.confirmlist[o].TxType)};if(console.log(i),i instanceof http_1.HttpParams)return"application/x-www-form-urlencoded;charset=UTF-8";this.reportservice.confirmationdownload(i).subscribe(function(t){file_saver_1.saveAs(t,r),e.loading=!1},function(t){console.log(t),console.log("here"),$("#message").modal({backdrop:"static",keyboard:!1,show:!0}),e.loading=!1})},t.prototype.type=function(t){switch(t){case"Subscription":return"SUB";case"Switching Out":return"SWO";case"Redemption":return"RDM";case"Switching In":return"SWI"}},t.prototype.print=function(){window.focus(),window.print()},t=__decorate([core_1.Component({selector:"app-confirmation",templateUrl:"./confirmation.component.html",styleUrls:["./confirmation.component.scss"]})],t)}();exports.ConfirmationComponent=ConfirmationComponent;