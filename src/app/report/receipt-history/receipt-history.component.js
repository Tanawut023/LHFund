"use strict";var __decorate=this&&this.__decorate||function(e,t,i,n){var o,r=arguments.length,d=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)d=Reflect.decorate(e,t,i,n);else for(var s=e.length-1;0<=s;s--)(o=e[s])&&(d=(r<3?o(d):3<r?o(t,i,d):o(t,i))||d);return 3<r&&d&&Object.defineProperty(t,i,d),d};Object.defineProperty(exports,"__esModule",{value:!0});var core_1=require("@angular/core"),operators_1=require("rxjs/operators"),http_1=require("@angular/common/http"),dateformat_1=require("../../Share/dateformat"),ReceiptHistoryComponent=function(){function e(e,t){this.basedataservice=e,this.reportservice=t,this.model={},this.userall={},this.userselect={},this.unitholderno="init",this.fundtype=0,this.fundname=0,this.current=1,this.row=999,this.p=1}return e.prototype.ngOnInit=function(){this.getSelectListUnitholder(),this.getfundtypelist(),$("#mutual-tab-menu").find("li").removeClass("current"),$("#mutual-tab-menu").find("li#menu3").addClass("current")},e.prototype.onChange=function(){for(var e=0;e<this.userall.unitholderlist.length;e++)this.userall.unitholderlist[e].UnitholderId==this.unitholderno.UnitholderId&&(this.userselect=this.userall.unitholderlist[e])},e.prototype.changefundtype=function(){var t=this;console.log(this.fundtype);var e=this.fundtype,i=new http_1.HttpParams;i=i.append("fundtypeid",e),this.reportservice.changefundtype(i).pipe(operators_1.first()).subscribe(function(e){console.log(e),t.Fundnamelist=e.fundlist},function(e){console.log(e)})},e.prototype.getstartdate=function(){return this.model.startDate.year+"-"+this.model.startDate.month+"-"+this.model.startDate.day},e.prototype.getenddate=function(){return this.model.endDate.year+"-"+this.model.endDate.month+"-"+this.model.endDate.day},e.prototype.getSelectListUnitholder=function(){var t=this;this.basedataservice.getSelectListUnitholder().pipe(operators_1.first()).subscribe(function(e){console.log(e),t.userall=e,t.unitholderno=t.userall.unitholderlist[0],t.userselect=t.userall.unitholderlist[0]},function(e){console.log(e)})},e.prototype.getfundtypelist=function(){var t=this;this.reportservice.getfundtypelist().subscribe(function(e){console.log(e),t.Fundtypelist=e.fundtypelist},function(e){console.log(e)})},e.prototype.OnSubmitd=function(){var e,t=this,i=new http_1.HttpParams;i=(i=i.append("currentpage","1")).append("rowperpage","999"),console.log(this.model),"0"==this.fundtype&&void 0===this.model.startDate?(console.log(this.fundtype),console.log("test"),e={UnitholderID:this.userselect.UnitholderId}):"0"!==this.fundtype&&void 0===this.model.startDate&&void 0!==this.fundname.FundCode?(console.log(this.fundtype),console.log("test4"),e={UnitholderID:this.userselect.UnitholderId,FundTypeID:this.fundtype,FundCode:this.fundname.FundCode}):void 0!==this.model.startDate&&"0"==this.fundtype?(console.log("test3"),e={UnitholderID:this.fundtype,StartXDDate:this.getstartdate(),EndXDDate:this.getenddate()}):(console.log("test2"),console.log(this.fundname),e={UnitholderID:this.userselect.UnitholderId,FundTypeID:this.fundtype,FundCode:this.fundname.FundCode,StartXDDate:this.getstartdate(),EndXDDate:this.getenddate(),TransactionDate:dateformat_1.getDate()}),console.log(e),this.reportservice.dividendreport(e,i).subscribe(function(e){console.log(e),t.dividendreport=e,t.calulatetable()},function(e){console.log(e)})},e.prototype.calulatetable=function(){new Array;var e=new Array;console.log("test");for(var t=0,i=1,n=0,o=0;o<this.dividendreport.dividendreport.length;o++){console.log("fori");var r=0,d=0,s=0,l=0;this.dividendreport.dividendreport[o].DividendPayment.length,this.dividendreport.dividendreport[o].DividendPayment.length;n+=this.dividendreport.dividendreport[o].DividendPayment.length;for(var a=0;a<this.dividendreport.dividendreport[o].DividendPayment.length;a++){var p;console.log("fory"),r+=parseFloat(this.dividendreport.dividendreport[o].DividendPayment[a].BalanceUnit),d+=parseFloat(this.dividendreport.dividendreport[o].DividendPayment[a].DividendWithHoldingTax),s+=parseFloat(this.dividendreport.dividendreport[o].DividendPayment[a].NetDividendAmount),p=this.dividendreport.dividendreport[o].DividendPayment[a],0!=t&&0!=l||this.dividendreport.dividendreport[o].FundCode==p.FundCode&&(p.FundCode=this.dividendreport.dividendreport[o].FundCode,p.FundName=this.dividendreport.dividendreport[o].FundName,p.FundNameEng=this.dividendreport.dividendreport[o].FundNameEng),9!=t&&i!=n||(p.balance=r,p.tax=d,p.net=s,s=d=r=0),e.push(p),console.log(p),l++,i++,0,10==++t&&(t=0)}}this.reportlist=e,console.log(this.reportlist)},e.prototype.reset=function(){console.log("reset"),this.Fundnamelist=[],this.fundtype=0,this.fundname=0,this.dividendreport="",this.model={}},e=__decorate([core_1.Component({selector:"app-receipt-history",templateUrl:"./receipt-history.component.html",styleUrls:["./receipt-history.component.scss"]})],e)}();exports.ReceiptHistoryComponent=ReceiptHistoryComponent;